{% extends 'base.html.twig' %}

{% block title %}D√©tail du rendez-vous{% endblock %}

{% block body %}
<div class="container content-wrapper" style="max-width: 800px;">

    <h1 class="mb-4">D√©tail du rendez-vous</h1>

    <div class="card" style="padding: 20px;">
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
            
            <div>
                <strong>Date</strong><br>
                {{ rendez_vou.debut|date('d/m/Y') }}
            </div>

            <div>
                <strong>Heure</strong><br>
                {{ rendez_vou.debut|date('H:i') }} ‚Äì {{ rendez_vou.fin|date('H:i') }}
            </div>

            <div>
                <strong>M√©decin</strong><br>
                Dr {{ rendez_vou.medecin.nom }}
            </div>

            <div>
                <strong>Patient</strong><br>
                {{ rendez_vou.patient.prenom }} {{ rendez_vou.patient.nom }}
            </div>

            <div>
                <strong>√âtat</strong><br>
                <span class="badge
                    {% if rendez_vou.etat.libelle == 'demand√©' %}badge-info{% endif %}
                    {% if rendez_vou.etat.libelle == 'confirm√©' %}badge-success{% endif %}
                    {% if rendez_vou.etat.libelle in ['annul√©', 'refus√©'] %}badge-danger{% endif %}
                    {% if rendez_vou.etat.libelle == 'realis√©' %}badge-primary{% endif %}
                ">
                    {{ rendez_vou.etat.libelle|capitalize }}
                </span>
            </div>

        </div>
    </div>

    <div class="mt-4" style="display:flex; gap:10px; flex-wrap:wrap;">

        {# üîß Modifier : uniquement si √©tat = demand√© #}
        {% if rendez_vou.etat.libelle == 'demand√©' %}
            <a href="{{ path('app_mes_rendez_vous_edit', { id: rendez_vou.id }) }}"
               class="btn btn-warning">
                Modifier le rendez-vous
            </a>
        {% endif %}

        {# ‚ùå Annuler : si pas r√©alis√© / annul√© / refus√© #}
        {% if rendez_vou.etat.libelle not in ['realis√©', 'annul√©', 'refus√©'] %}
            <form method="post"
                  action="{{ path('app_mes_rendez_vous_cancel', { id: rendez_vou.id }) }}"
                  onsubmit="return confirm('√ätes-vous s√ªr de vouloir annuler ce rendez-vous ?');">
                <button class="btn btn-danger">
                    Annuler le rendez-vous
                </button>
            </form>
        {% endif %}

        <a href="{{ path('app_mes_rendez_vous') }}" class="btn btn-secondary">
            Retour √† mes rendez-vous
        </a>

    </div>

</div>
{% endblock %}
