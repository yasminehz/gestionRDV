{# Header / navigation partagé pour tout le site #}
<header class="site-header">
  <div class="container">
    <a class="brand" href="{{ path('homepage') }}">
      <div class="brand-logo" aria-hidden="true">RD</div>
      <div class="brand-title">MonCabinet</div>
    </a>

    {# bouton mobile pour ouvrir/fermer la nav #}
    <button id="navToggle" class="btn btn-outline" aria-expanded="false" aria-controls="mainNav" title="Menu">
      ☰
    </button>

    <nav id="mainNav" class="site-nav" role="navigation">
      <a href="{{ path('prendre_rdv') }}">Prendre RDV</a>
      <a href="{{ path('medecin_index') }}">Médecins</a>

      {# si connecté, lien vers ses demandes/réservations #}
      {% if app.user %}
        <a href="{{ path('mes_demandes') }}">Mes RDV</a>

        {# liens selon rôle (adapter les roles si nécessaire) #}
        {% if is_granted('ROLE_MEDECIN') %}
          <a href="{{ path('medecin_dashboard') }}">Espace Médecin</a>
        {% endif %}

        {% if is_granted('ROLE_ASSISTANT') %}
          <a href="{{ path('assistant_dashboard') }}">Espace Assistant</a>
        {% endif %}

        {# Profil + déconnexion #}
        <a href="{{ path('app_profile') }}">{{ app.user.username ?: app.user.email }}</a>

        <form id="logoutForm" action="{{ path('app_logout') }}" method="post" style="display:inline;">
          <button class="btn btn-outline" type="submit">Se déconnecter</button>
        </form>
      {% else %}
        <a href="{{ path('app_login') }}" class="btn btn-primary">Se connecter</a>
        <a href="{{ path('app_register') }}" class="btn btn-outline">S'inscrire</a>
      {% endif %}
    </nav>
  </div>

  {# petit script pour basculer la nav mobile (très simple) #}
  <script>
    (function () {
      const toggle = document.getElementById('navToggle');
      const nav = document.getElementById('mainNav');
      if (!toggle || !nav) return;
      toggle.addEventListener('click', () => {
        const expanded = toggle.getAttribute('aria-expanded') === 'true';
        toggle.setAttribute('aria-expanded', String(!expanded));
        nav.style.display = expanded ? '' : 'flex';
      });

      // Masquer la nav sur petit écran au chargement
      function handleResize() {
        if (window.innerWidth <= 980) {
          nav.style.display = 'none';
        } else {
          nav.style.display = 'flex';
        }
      }
      handleResize();
      window.addEventListener('resize', handleResize);
    })();
  </script>
</header>